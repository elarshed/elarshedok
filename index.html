<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store Profit Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background: #f0f4f8; color: #1a202c; padding: 1rem; }
        .container { background: #fff; border-radius: 0.75rem; padding: 1rem; max-width: 800px; margin: 0 auto; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        .inputs-section, .results-section { padding: 1rem; background: #e6f0fa; border-radius: 0.75rem; margin-bottom: 1rem; }
        .inputs-container, .results-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .input-group { display: flex; flex-direction: column; gap: 0.3rem; }
        .input-group label { font-weight: 700; color: #2b6cb0; }
        .input-group input { padding: 0.5rem; border: 1px solid #2b6cb0; border-radius: 0.5rem; font-weight: 700; }
        .result-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 0.5rem; text-align: center; }
        .result-card p:first-child { font-weight: 700; color: #2b6cb0; }
        .result-card p:last-child { font-weight: 900; font-size: 1.2rem; }
        .text-green-600 { color: #38a169; }
        .text-red-600 { color: #e53e3e; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Inputs Section -->
        <div class="inputs-section">
            <h2>مدخلات التكاليف والمبيعات</h2>
            <div class="inputs-container">
                <div class="input-group">
                    <label><i class="fas fa-box"></i> سعر المنتج</label>
                    <input type="number" id="productCost" step="any" min="0" value="100">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-warehouse"></i> تكلفة التخزين الشهرية</label>
                    <input type="number" id="storageCost" step="any" min="0" value="500">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-truck"></i> تكلفة الشحن لكل طلب</label>
                    <input type="number" id="shippingCost" step="any" min="0" value="20">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-ad"></i> تكلفة الإعلان لكل طلب</label>
                    <input type="number" id="adCostPerOrder" step="any" min="0" value="15">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-dollar-sign"></i> سعر البيع لكل طلب</label>
                    <input type="number" id="sellingPrice" step="any" min="0" value="200">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-percentage"></i> نسبة التسليم الناجح (%)</label>
                    <input type="number" id="deliveryRate" step="any" min="0" max="100" value="80">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-cogs"></i> تكاليف التشغيل الشهرية</label>
                    <input type="number" id="operationalCost" step="any" min="0" value="1000">
                </div>
                <div class="input-group">
                    <label><i class="fas fa-shopping-cart"></i> عدد الطلبات المستهدفة</label>
                    <input type="number" id="targetOrders" step="1" min="0" value="50">
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section">
            <h2>النتائج المالية</h2>
            <div class="results-container" id="results">
                <div class="result-card">
                    <p>إجمالي تكلفة كل طلب</p>
                    <p id="totalCostPerOrder"></p>
                </div>
                <div class="result-card">
                    <p>السعر الأدنى للبيع</p>
                    <p id="breakevenPrice"></p>
                </div>
                <div class="result-card">
                    <p>السعر المناسب للبيع</p>
                    <p id="recommendedPrice"></p>
                </div>
                <div class="result-card">
                    <p>هامش الربح لكل طلب</p>
                    <p id="profitMargin"></p>
                </div>
                <div class="result-card">
                    <p>صافي الربح الشهري</p>
                    <p id="netProfitMonthly"></p>
                </div>
                <div class="result-card">
                    <p>العائد على الإعلانات (ROAS)</p>
                    <p id="roas"></p>
                </div>
                <div class="result-card">
                    <p>طلبات لتغطية التكاليف</p>
                    <p id="ordersToCoverCosts"></p>
                </div>
                <div class="result-card">
                    <p>التدفق النقدي المتوقع</p>
                    <p id="cashFlow"></p>
                </div>
                <div class="result-card">
                    <p>الخسائر من المرتجعات</p>
                    <p id="returnLosses"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const currencySymbol = 'ج.م'; // يمكن إضافة اختيار العملة لاحقًا

        const calculateResults = () => {
            // Inputs
            const productCost = parseFloat(document.getElementById('productCost').value) || 0;
            const storageCost = parseFloat(document.getElementById('storageCost').value) || 0;
            const shippingCost = parseFloat(document.getElementById('shippingCost').value) || 0;
            const adCostPerOrder = parseFloat(document.getElementById('adCostPerOrder').value) || 0;
            const sellingPrice = parseFloat(document.getElementById('sellingPrice').value) || 0;
            const deliveryRate = parseFloat(document.getElementById('deliveryRate').value) || 0;
            const operationalCost = parseFloat(document.getElementById('operationalCost').value) || 0;
            const targetOrders = parseFloat(document.getElementById('targetOrders').value) || 0;

            // Calculations
            const storageCostPerOrder = targetOrders ? storageCost / targetOrders : 0;
            const totalCostPerOrder = productCost + shippingCost + adCostPerOrder + storageCostPerOrder;
            const breakevenPrice = totalCostPerOrder; // السعر الأدنى لتغطية التكاليف
            const profitMarginTarget = 0.3; // هدف هامش ربح 30% (يمكن تعديله)
            const recommendedPrice = totalCostPerOrder / (1 - profitMarginTarget); // السعر الموصى به
            const profitPerOrder = sellingPrice - totalCostPerOrder;
            const profitMargin = sellingPrice ? (profitPerOrder / sellingPrice) * 100 : 0;

            const deliveredOrders = targetOrders * (deliveryRate / 100);
            const returnRate = 100 - deliveryRate;
            const returnedOrders = targetOrders * (returnRate / 100);
            const returnLosses = returnedOrders * totalCostPerOrder;

            const revenue = deliveredOrders * sellingPrice;
            const totalAdSpend = targetOrders * adCostPerOrder;
            const roas = totalAdSpend ? revenue / totalAdSpend : 0;
            const netProfitMonthly = revenue - (deliveredOrders * totalCostPerOrder) - operationalCost;
            const cashFlow = netProfitMonthly - returnLosses;
            const ordersToCoverCosts = operationalCost / profitPerOrder || 0;

            // Update Results
            const updateElement = (id, value, isPercentage = false, isNumberOnly = false) => {
                const element = document.getElementById(id);
                element.textContent = isPercentage ? `${value.toFixed(2)}%` : 
                                     isNumberOnly ? value.toFixed(0) : `${currencySymbol} ${value.toFixed(2)}`;
                element.classList.remove('text-red-600', 'text-green-600');
                element.classList.add(value >= 0 ? 'text-green-600' : 'text-red-600');
            };

            updateElement('totalCostPerOrder', totalCostPerOrder);
            updateElement('breakevenPrice', breakevenPrice);
            updateElement('recommendedPrice', recommendedPrice);
            updateElement('profitMargin', profitMargin, true);
            updateElement('netProfitMonthly', netProfitMonthly);
            updateElement('roas', roas);
            updateElement('ordersToCoverCosts', ordersToCoverCosts, false, true);
            updateElement('cashFlow', cashFlow);
            updateElement('returnLosses', returnLosses);
        };

        // Event Listeners
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculateResults);
        });

        // Initial Calculation
        calculateResults();
    </script>
</body>
</html>
